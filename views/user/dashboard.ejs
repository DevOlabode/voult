<% layout('layout/boilerplate.ejs') %>

<section class="dashboard">

  <header class="dashboard-header">
    <h1>Dashboard</h1>
    <p class="dashboard-subtext">
      Welcome back, <strong><%= user.name %></strong>
    </p>
  </header>

  <!-- Apps -->
  <section class="dashboard-section">
    <div class="section-header">
      <h2>Your Apps</h2>
      <a href="/app/new" class="btn-secondary btn-sm">New App</a>
    </div>

    <% if (apps.length === 0) { %>
      <div class="empty-state">
        <p>You haven’t created any apps yet.</p>
        <a href="/app/new" class="btn-primary">Create App</a>
      </div>
    <% } else { %>
      <div class="apps-grid">
        <% apps.forEach(app => { %>
          <div class="app-card">
            <h3><%= app.name %></h3>

            <% if (app.description) { %>
              <p class="muted"><%= app.description %></p>
            <% } %>

            <div class="app-meta">
              <span class="status <%= app.isActive ? 'active' : 'disabled' %>">
                <%= app.isActive ? 'Active' : 'Disabled' %>
              </span>
              <span class="date">
                <%= app.createdAt.toDateString() %>
              </span>
            </div>

            <div class="app-actions">
              <a href="/app/<%= app._id %>" class="link">
                Manage →
              </a>
            
              <a href="/apps/<%= app._id %>/edit" class="btn-link">
                Edit
              </a>
            </div>
          </div>
        <% }) %>
      </div>
    <% } %>
  </section>

  <!-- Account -->
  <section class="dashboard-section">
    <h2>Account</h2>

    <div class="account-card">
      <div><strong>Email:</strong> <%= user.email %></div>
      <div><strong>Plan:</strong> <%= user.plan %></div>
      <div><strong>Joined:</strong> <%= user.createdAt.toDateString() %></div>
    </div>
  </section>

  <form action="/logout" method="POST" class="logout-form">
    <button class="btn-danger">Logout</button>
  </form>

</section>
