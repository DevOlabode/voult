<% layout('layout/boilerplate.ejs') %>

<section class="manage-app">

  <header class="page-header">
    <div>
      <h1><%= app.name %></h1>
      <p class="muted"><%= app.description || 'No description provided.' %></p>
    </div>
  
    <div class="header-actions">
      <a href="/app/<%= app._id %>/edit" class="btn-secondary btn-sm">
        Edit App
      </a>
    </div>
  </header>
  

  <!-- App Details -->
  <section class="card">
    <h2>App Details</h2>

    <div class="detail-row">
      <span>Name</span>
      <span><%= app.name %></span>
    </div>

    <div class="detail-row">
      <span>Callback URL</span>
      <span><%= app.callbackUrl %></span>
    </div>

    <div class="detail-row">
      <span>Status</span>
      <span class="status <%= app.isActive ? 'active' : 'disabled' %>">
        <%= app.isActive ? 'Active' : 'Disabled' %>
      </span>
    </div>

    <div class="detail-row">
      <span>Created</span>
      <span><%= app.createdAt.toDateString() %></span>
    </div>
  </section>

  <!-- API Credentials -->
  <section class="card">
    <h2>API Credentials</h2>

    <div class="api-box">
      <code><%= app.clientId %></code>
      <small>Client ID</small>
    </div>
    
    <div class="api-box">
      <code>••••••••••••••••</code>
      <small>Client Secret</small>
    </div>
    
    <form action="/app/<%= app._id %>/rotate-secret" method="POST">
      <button class="btn-secondary">Rotate Client Secret</button>
    </form>

    <p class="hint">
      Never expose your client secret in frontend code.
    </p>
  </section>

  <!-- Actions -->
  <section class="card">
    <h2>Actions</h2>

    <form action="/app/<%= app._id %>/toggle" method="POST" class="action-spacing">
      <button class="btn <%= app.isActive ? 'btn-danger' : 'btn-secondary' %> ">
        <%= app.isActive ? 'Disable App' : 'Enable App' %>
      </button>
    </form>
    

      <form
        action="/app/<%= app._id %>?_method=DELETE"
        method="POST"
        onsubmit="return confirm('Are you sure you want to delete this app?');"
      >
        <button class="btn-secondary">
          Delete App
        </button>
      </form>
    </div>
  </section>

  <a href="/dashboard" class="link-back">← Back to Dashboard</a>

</section>
